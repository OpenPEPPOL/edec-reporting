include::./settings.adoc[]

:description: Peppol Central Reporting platform (CRP) collects statistics that is sent by the Peppol Service Providers and aggregates the collected data into reports that are submitted to OpenPeppol and later also the Peppol Authorities.
:icons: font
:stem:
:toc: left
:hugo-weight: 1
:toclevels: 2
:source-highlighter: coderay
:source-language: xml
:sectanchors:
:sectnums:
image::./images/peppol.png[pdfwidth=3.5in,align=center]

= {doctitle}

{name-op-en}
v{version}

:leveloffset: +1

= Introduction

Transaction Statistics Reporting  of production data helps the Peppol Coordinating Authority and PAs to monitor the operations of the Peppol Network and identify and manage risks and issues within the network. The reporting requirements towards SPs are divided into two areas: reporting about Transaction Statistics data and reporting about Transaction Statistics. This operational procedure will explain and outline the operational procedures for the Transaction statistics Reporting. The policy on reporting is stated in Internal Regulations for Use of the Peppol Network.


== Scope

//NOTE: Add what is in scope explicitly it can be just a paragraph

This document sets out the processes and procedure for Transaction Statistics Reporting process including:

.	Parties and Roles,
.	Document Structure,
.	Data gathered, 
.  Reporting Rules.

NOTE: To be completed

== Audience

* Peppol Coordinating Authority reports
   - how the Peppol Coordinating Authority will make consolidated statistical reports available for public consumption.

* Service Provider (SP)
- how SPs are to submit reports on their Transaction Statisticss on transactions to the Peppol Coordinating Authority.

More specifically, roles addressed are the following:

** ICT Architects
** ICT Developers
** Business Experts

== References

* https://openpeppol.atlassian.net/wiki/spaces/AF/pages/2756772071/Other+Files[Internal Regulations - Use of Peppol Network_v1.0s]

* https://openpeppol.atlassian.net/wiki/spaces/AF/pages/2756771841/New+Peppol+Agreements+and+accompanying+documents#B3.-Operational-Procedures[Non-compliance Operational Procedure].

= Document Structure

* Introduction

Provide general informations about Transaction statistics Reporting business Process.

* Document Structure

   Provide Helpfull informationabout this document structure.

* Reporting Business Process

   Provide the reader with information on how to implement the Transaction Statistics Reporting Process.

* Business Information

   Provide the reader with functionnal information for the Transaction Statistics Reporting Process.

* Rules

   Provide the reader with information on the business rules to be respected for the Transaction Statistics Reporting Process.

* Technical Details

   Provide the reader with information on the technical aspects for the implementation of the Transaction Statistics Reporting Process.

= Reporting Business Process

== Parties and Roles

:leveloffset: +1
The following roles may be specified. 

== Service Provider (SP) 

Service Provider  is mandatory information and provided in element 

`eur:EndUserReport / eur:Header / eur:ReporterID`

.EUR example of Service Provider information
[source, xml, indent=0]

    <ReporterID schemeID="CertSubjectCN">POP000360</ReporterID>


. Service Provider  schemeID (IBT-060-1), mandatory, the identification scheme identifier shall be chosen from the entries of the list published by the https://www.iso.org/standard/25773.html[ISO/IEC 6523] maintenance agency.
. ReporterID (IBT-060) the value of the Peppol AP Certificate Subject CN (Common Name) to uniquely identify the Service Provider that is providing the data.

SPs will:

* Collect relevant data, taking care with the accuracy and validity of this data.
*	Report this data in accordance to this document. This interface allows for a standardized and structured dataset from where the Peppol Coordinating Authority can automate processing and aggregation of the data upon receival in the Peppol Reporting Platform.
* Ensure all data for a month is reported within 10 calendar days following the end of the month.
* Transmit the Peppol Transaction Statistics Report BIS to the Peppol Coordinating Authority in accordance with this specification.

== OpenPeppol Operating Office (OO)

operating Office is mandatory information and provided in element ` ?????`

.EUR example of Operating Office information
[source, xml, indent=0]
<ProfileID>urn:fdc:peppol.eu:oo:bis:reporting:1</ProfileID> 

NOTE: to be corrected

. Operating Office identifier  (IBT-002), identifies the business process context in which the transaction appears, to enable the receiver to process the document in an appropriate way.

The OpenPeppol Operating Office (OO) will:

* Automatically check which providers have not submitted their Transaction Statistics Report. This check will be triggered automatically.
* Prompt any SPs that have not submitted the Transaction Statistics Report.
* Prompting will be done by email and not by eDelivery
* Define that in due time is supposed to be 5 days, giving it a total of 15 days
* Prompt the PA of the SP if a SP fails to submit the Transaction Statistics Report in due time after reminders are sent. The PA of the SP will be informed to handle this as a non-compliance issue.
* Failure by SPs to provide full and complete reports can be managed in accordance with the https://openpeppol.atlassian.net/wiki/spaces/AF/pages/2756771841/New+Peppol+Agreements+and+accompanying+documents#B3.-Operational-Procedures[Non-compliance Operational Procedure].

:leveloffset: -1

== Transaction Statistics Reporting Process

NOTE: Consolidated Diagram and process overview to be added

=== Data Gathering
// NOTE: Elaboration on Business Requirements (see Philip's excel file) on Data Gathering

- The "reporting period" starts with the first day of every month at 00:00:00 UTC (inclusive) and ends with the last day of said month at 23:59:59 UTC (inclusive)
- If a Service Provider initiates its Peppol activities during a reporting period, this particular reporting period starts for this Service Provider at the initiation point in time.
- If a Service Provider ends its Peppol activities during a reporting period, this particular reporting period ends for this Service Provider at the ending point in time. The report must be send anyway.
- Only Service Providers offering the exchange of Dataset Types must fill out and transmit Transaction Statistics
Data for test and production must be gathered separately
- All outgoing datasets to which a positive transport level acknowledgment was received must be counted ("outgoing countable dataset")
- All incoming datasets to which a positivie transport level acknowledgement was sent must be be counted ("incoming countable dataset")




=== Data Aggregation

//NOTE: Elaboration on Business Requirements (see Philip's excel file) on Data Aggregation

Service Provider should provide the data with the following level of aggregation:

* Aggregation per SP
- The count of incoming and outgoing Transactions per Service Provider.  


* Aggregation per country
- The count of incoming and outgoing Transactions per country.


* Aggregation per Dataset Type 
- The count of incoming and outgoing Transactions per documents type.

* Aggregation per Transport Profile
- The count of incoming and outgoing Transactions per Transport Profile.

to be added  ?

Per SP + Dataset Type  + Transport Protocol

Per SP + Country code 

?? per TRansport Prototcol and document type ??


=== Data Transmission
NOTE: Elaboration on Business Requirements (see Philip's excel file) on Data Transmission

- Transaction Statistics must be transmitted once per month ("reporting period")
- Only Transaction Statistics on the Production stage must be transmitted
- Transaction Statistics must be transmitted within 10 days (inclusive) after the end of the previous reporting period
- The report must be transmitted, even if no Peppol transactions happened
- In case the report of one Service Provider is received multiple times, only the latest received document will be evaluated
- The begin and end date of the reporting period must be part of the transmission data
- An identifier uniquely identifying the reporting Service Provider must be part of the transmission data
- Transaction Statistics must be transmitted via the Peppol eDelivery Network
- Transaction Statistics must be transmitted to the Peppol Participant iD XXXXX



= Business Information
:leveloffset: +1
NOTE: Description of the details on the semantic model of the Message. Header, Reporting Period (Previous Section 3). Link to the processes
include::./doc-section/technical/description/index.adoc[]
:leveloffset: -1

= Rules

//NOTE: Technical Business rules that concern the *information of the Message*

include::./doc-section/technical/businessrules/index.adoc[]


== Calculations

NOTE: do we split per aggregation ???

* For outgoing datasets, the receiving Service Provider (C3) MUST be counted. The sending Service Provider ID MUST in this case match the value "Header/ReporterCertSubjectCN".
* For incoming datasets, the sending Service Provider (C2) MUST be counted. * The receiving  Service Provider ID MUST in this case match the value "Header/ReporterCertSubjectCN".
* The sum of all exchange datasets per Service Provider MUST equal the TotalCount.

= Technical Details

//NOTE: Technical information on semantic and syntax binding. Data Types, Identifiers, schema

include::./doc-section/technical/datatypes/index.adoc[]

//== Primitive Data Types

//NOTE: ISO 15000, Annex A (see PINT) of primitive types used in the syntax binding.

//== Semantic Data Types

//NOTE: Richer definition of types, based on primitive times and optionally external rules.

== Code lists

include::./doc-section/technical/codelists/index.adoc[]

== BIS Identifiers

include::./doc-section/technical/namespace.adoc[]

:leveloffset: -1




















//*******************************************************************************888 */


# Transaction-Statistics Reporting
Version 1.0-DRAFT

include::./settings.adoc[]

:description: Peppol Central Reporting platform (CRP) collects statistics that is sent by the Peppol Service Providers and aggregates the collected data into reports that are submitted to OpenPeppol and later also the Peppol Authorities.
:icons: font
:stem:
:toc: left
:hugo-weight: 1
:toclevels: 2
:source-highlighter: coderay
:source-language: xml
:sectanchors:
:sectnums:
:CIUS: Core Invoice Usage Specification (CIUS)
image::./images/peppol.png[pdfwidth=3.5in,align=center]
== {doctitle}

{name-op-en}
v{version}

This document sets out the processes and procedures for Transaction Statistics reporting data in the Peppol environment. 
    
*Target Audience:*

* Service Provider (SP) 
   - how SPs are to submit reports on their Transaction Statisticss on transactions to the Peppol Coordinating Authority. 

* Peppol Coordinating Authority reports
   - how the Peppol Coordinating Authority will make consolidated statistical reports available for public consumption.

*Out of scope:*

// extend 

* Peppol Authority (PA)
   - how PAs can access and download the information from the Peppol Coordinating Authority.

* PA usage
   - how PAs will use and share statistical information/reports is managed by each PA.

* Local or regional domains
   - reporting of information for activities within local or regional domains is the responsibility of the PAs owner of those domains. Local and regional domains are required to keep the Peppol Coordinating Authority informed of its activities.

* Operational reports
   - Management reports relating to workloads and workflow (e.g. change requests, extended use requests, issues and incidents, non-compliance, etc.) are managed by the OpenPeppol Operating Office as part of its operations.

//== Link to main site of documentation

//https://docs.peppol.eu/poacc/billing/3.0/[Main documentation site]  (to be changed to reporting main doc site when existing)


/**link:/reporting/EndUserReporting/[Main documentation site]*/

:leveloffset: +1


include::./doc-section/introduction.adoc[Introduction]

include::./doc-section/business-processes.adoc[]

//** include::./doc-section/business-info.adoc[]*/


//**include::./doc-section/rules.adoc[]*/

//**include::./doc-section/technical.adoc[]*/

:leveloffset: -1